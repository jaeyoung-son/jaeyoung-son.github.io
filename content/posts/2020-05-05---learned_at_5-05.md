---
title: '배움 정리하기'
date: '2020-05-05T12:10:32.169Z'
template: 'post'
draft: false
slug: '/posts/learned_5-05/'
category: 'learn'
description: '배움 정리 하기'
tags:
  - 'learn'
---

## 그날그날 배운것들을 기록하자.

## 스크롤바 없애기

보통 웹에서 특정 설정을 해주지 않으면 내용물이 뷰포트 크기를 넘을떄 스크롤이 생긴다 세로로 넘으면 세로스크롤, 가로로 넘기면 가로스크롤이 생긴다. 때에따라서 이 스크롤바를 보여주고싶지 않을 떄가 있다.  
몇가지 css를 적용해주면 스크롤바를 숨길 수 있다.

```css
.box {
  -ms-overflow-style: none; /* IE 와 Edge */
  scrollbar-width: none; /* firefox */
}

.box::-webkit-scrollbar {
  display: none; /* chrome, safari, opera */
}
```

브라우저별 셋팅이 조금씩 다르니 참고해야한다.

## 스크롤 이벤트시 쓰로틀 적용

스크롤이벤트를 적용하면 사용자가 스크롤을 할때마다 감지되고 실행이 된다. 단순 콘솔로그만 찍어도 콘솔이 어마어마하게 많이 실행되는것을 알 수 있다. 스크롤 감지 자체가 큰 부담이 아니라고는 하지만 나름 줄여줄 수 있으면 깔끔하게 적용해보려고 하였다.  
보통 throttle과 debounce를 이용하여 시간이 지남에 따라 함수를 몇번 실행할지 제어하는데 두개는 차이를 가지고있다.

### 디바운스

디바운스는 그룹화하여 특정시간이 지난 후 하나의 이벤트만 발생하도록 하는 것 즉, 순차적 호출을 하나의 그룹으로 그룹화 한다. 연이어 호출되는 함수중 가장 마지막이나 가장 처음만 호출하도록 하는것.

### 쓰로틀

쓰로틀은 이벤트를 일정한 주기마다 발생하도록 하는것 쓰로틀에 설정시간으로 1s를 주면 해당 이벤트는 1s동안은 한번만 실행된다.  
쓰로틀을 적용해보기로하고 쓰로틀 함수를 정의해줬다

```js
export default function throttle(fn, delay) {
    let timer;
    return function () {
    if (!timer) {
    timer = setTimeout (function () {
        timer = null;
        fn.apply(this, arguments);
        },delay)
    }
}
```

쓰로틀 이라는 함수에서 인자로 함수와 딜레이시간을 받는다. 그리고 타이머 변수를 하나 선언하고 쓰로틀 함수는 함수를 리턴하는데 그 함수는 타이머를 !timer 조건이 맞을 때 타이머를 setTimeout으로 함수를 넣어주고 그 함수 내부에서 timer = null이며 쓰로틀함수에서 인자로 받은 함수를 apply로 호출하고 셋타임아웃의 딜레이시간은 쓰로틀 함수에서 인자로 받은 시간이다. apply호출 같은경우 this를 공부할때 this를 어떻게 적용시킬지 호출단계에서 정해주는 느낌으로 받아들였는데 완전히 이해하지 않았다. 이렇게 쓰로틀 함수를 뺴놓고 사용할곳에서 import 해주고 사용한다

```jsx
import throttle from '../throttle'

const scrollEvent = ....

window.addEventListener('scroll', throttle(scrollEvent, 1000))
// 스크롤 이벤트를 scrollEvent라는 함수를 걸어주고 그 함수는 1초마다 한번 실행

```

이렇게 하면 콘솔을 찍어도 전처럼 마구마구 찍히지 않는것을 확인할 수 있다.

## 웹팩 빌드 시 dist폴더에서 디렉토리 적용

웹팩 빌드를 할 때 dist폴더에 js파일과 css파일을 빌드하는데 js파일은 js디렉토리에 들어간다음 그안에서 빌드가 되었는데 css파일은 바로 dist폴더에서 빌드가 되었다.

```
- dist
-- a.css
-- b.css
-- js
--- a.js
--- b. js
```

기존의 세팅

```js
{
loader: MiniCssExtractPlugin.loader,
options: {
    publickPath: '/app/dist/css/'
}
... 나머지 css로더들

plugins: [
new MiniCssExtractPlugin({
filename: '[name].css'
})
]
}
```

일단 셋팅에서 엔트리포인트가 한개가 아닌 두개여서 헷갈리는 부분이 많았고 아웃풋 셋팅에서 js파일들은 잘 js디렉토리를 바라보고 있길래 잘 들어갈줄알았지만 그러지 않았다. 그러다가 아웃풋에서 js 파일들을 어떻게 뱉는지 보았더니

```js
output: {
filename: 'js/[name].bundle.js'
...
}
```

파일네임 앞에 js/ 가 있고 그리고 js디렉토리 안에 빌드가 되었다 혹시나 MiniCssExtractPlugin에서도 적용을 시키면 잘될까 확인을 해보았다.  
세팅 후

```
{
loader: MiniCssExtractPlugin.loader,
options: {
    publickPath: '/app/dist/css/'
}
... 나머지 css로더들

plugins: [
new MiniCssExtractPlugin({
filename: 'css/[name].css'
})
]
```

그러니 이제 css파일들이 dist/css/a.css 이렇게 css디렉토리에 들어간것을 확인할 수 있었다,

## 모바일 기기로 접속 시 스크롤 튕김 현상

모바일뷰를 작업할떄애는 보통 크롬에서 개발자도구를 켜고 작업을 한다. 그래서 아무런 문제가 없음을 확인하며 작업을 진행했었는데 실제 모바일 디바이스로 체크를 해보니 스크롤할때마다 중간중간에 잠긴것처럼 튕기고 스크롤이 안될때가 있었다. 그래서 처음에는 스크롤이벤트에 걸려있는 내용이 문젠줄 알았었는데 이벤트 내용을 살펴보아도 원인을 찾기 어려웠다. 그러던중 맥과 아이폰을 연결하고 모바일사파리 화면에서 보고있을떄 맥사파리에서 개발자도구로 요소검사를 할 수 있다는 것을 알게되어서 그렇게 체크를 해보았다. 그래서 이 요소 저 요소 만지고있었는데 최상단 div에

```css
.main {
  overflow-x: hidden;
}
```

이 걸려있던것을 지웠더니 정상적으로 작동되는것을 확인하였다. 사파리 연동 요소검사를 잘 활용해야겠다.

## 스크롤탑 smooth가 안먹던 현상

버튼 클릭시 스크롤을 최상단으로 올려주는 이벤트가 있었는데 자바스크립트 scrollTo()함수를 사용하여 옵션으로 smooth를 주고 서서히 올라가게 기능을 짰다. 이 역시 크롬에서 개발자도구로 확인할떄 아무 문제없이 잘 되었었는데, ios기기에서 버튼을 클릭했을 때, smooth없이 그냥 다이렉트로 한번에 화면전환이 되었다.  
안드로이드기기에서 체크해보니 또 안드로이드에서는 잘 작동하였다. 어찌 ios에서도 적용할지 고민해보다가 react-scroll 라이브러리를 써서 윈도우 이벤트가아닌 라이브러리로 이벤트를 구현해보았고, 라이브러리의 애니메이션을 활용하였다.

```jsx
import { animationScroll } from 'react-scroll';

const scrollTop = () => {
  animation.scrollToTop();
};
```

그랬더니 적용 후 아이폰에서도 smooth 애니메이션이 잘 적용되었다.

## in 문법

이번에 새로 알게된 자바스크립트의 신기한 문법중 하나가 in 문법이다. 배열안에 요소가 존재하는지 boolean값으로 반환하는 것인데 다음과 같다

```js
item in arr;
// 아이템이 arr에 있다면 true 없다면 false
```

적용 한다면 다음과 같다

```js
const arr = [1, 2, 3, 4, 5];

console.log(1 in arr); // true
console.log(6 in arr); // false
```

유용하게 사용할 수 있는 것 같아서 기억해두고 필요 시 사용해야겠다.
